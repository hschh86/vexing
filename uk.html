<!DOCTYPE html>
<html lang="en">
 <head>
	<meta charset='utf-8'>
	<title> Union Jack </title>
    <!--
	<link rel="stylesheet" href="">
	<script src=""></script>
    -->

    <script src="scripts/fsvg.js"></script>
    <script src="scripts/flagshapes.js"></script>
    <script src="scripts/fcontrols.js"></script>

    <!-- Temporary style. -->
    <style>
      #main_svg_object {
        border: 1px solid black;
      }
      body {
        font-family: sans-serif;
      }
      /*workaround for strange firefox issue*/
      input[type=range] {
        background-color: unset;
      }

      input[type=number] {
        min-width: 1em;
        max-width: 3em;
      }

      .controlbox {
        display: flex;
        /*background-color: gray;*/
      }

      .controlbox label {
        /*font-family: monospace;*/
        /*display: inline;*/
        min-width: 10em;
        text-align: right;
      }


      /* Mask rules. */
      .solidmask {
        stroke: none;
        fill: white;
      }
    </style>

 </head>
 <body>
   <h1> united kingdom of great britain and northern ireland </h1>
   <div id="svgdiv">
     <svg id="main_svg_object"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="600" height="300" >
   </svg>
 </div>

 <!-- I'm not sure if this is appropriate here but it'll do -->
 <div id="flag-controls" class="controls">
   <fieldset id="dimensions">
     <legend> Dimensions </legend>
     <div id="flybox" class="controlbox rangeful">
       <label> Fly: <input type="number" id="fly" name="fly"> </label>
     </div>
     <div id="hoistbox" class="controlbox rangeful">
       <label> Hoist: <input type="number" name="hoist"></label>
     </div>
     <div id="ratiobox" class="controlbox outputbox">
       <label> Ratio: <output name="ratio"> output </output> </label>
     </div>
   </fieldset>
   <fieldset id="shapes">
     <legend> Shapes </legend>
     <fieldset id="saltire">
       <legend> Saltire </legend>
       <div id="saltire-patrickbox" class="controlbox">
         <label> Patrick? <input type="checkbox" name="patrick"></label>
       </div>
       <div id="saltire-widthbox" class="controlbox rangeful">
         <label> Width: <input type="number" name="salitre-width"></label>
       </div>
       <div id="saltire-fimbox" class="controlbox rangeful">
         <label> Fimbriation: <input type="number" name="saltire-fim"></label>
       </div>
       <div id="saltire-offsetbox" class="controlbox rangeful">
         <label> Offset: <input type="number" name="saltire-offset"></label>
       </div>
     </fieldset>
     <fieldset id="cross">
       <legend> Cross </legend>
       <div id="cross-widthbox" class="controlbox rangeful">
         <label> Width: <input type="number" name="cross-width"></label>
       </div>
       <div id="cross-fimbox" class="controlbox rangeful">
         <label> Fimbriation: <input type="number" name="cross-fim"></label>
       </div>
     </fieldset>
   </fieldset>
   <fieldset id="colours">
     <legend> Colours </legend>
     <div id="bluebox" class="controlbox">
       <label> Blue: <input type="color" name="blue"> </label>
     </div>
     <div id="whitebox" class="controlbox">
       <label> White: <input type="color" name="white"> </label>
     </div>
     <div id="redbox" class="controlbox">
       <label> Red: <input type="color" name="red"> </label>
     </div>
   </fieldset>
 </div>

 <script>

     window.onload = function () {
       'use strict';
       window.msvg = document.getElementById('main_svg_object');

      window.uu = new FlagShapes.UnionJack(60, 30, 'uk');
      uu.setBlue('navy');
      uu.setRed('red');
      uu.setWhite('white');
      uu.setCrossThickness(6);
      uu.setCrossFim(2);
      uu.setSaltireThickness(4);
      uu.setSaltireFim(1);

      uu.appendToNode(msvg);

      // Experiments With Thing.
      // use 'change' event for text/number boxes
      // to prevent changing while still typing
      // use 'input' for range (slider) for instant feedback
      // use 'change' for colour selector because having it affect
      // a different window just looks weird to me.

      // Also note: weird bug on firefox 50.2, GNOME
      // in which the slider is invisible unless the 'border' style is setSize
      // (which means it's invisible by default. It still works but you can't see it)

      // Add Rangeful Sliders
      document.querySelectorAll('.rangeful').forEach(function (node) {
        var spinner = node.querySelector('input[type=number]');
        // create slider
        var slider = document.createElement('input');
        slider.type = 'range';
        slider.id = slider.name = spinner.name + "_slider";
        slider.classList.add('rangeful_slider');
        slider.min = spinner.min
        slider.max = spinner.max
        slider.value = spinner.value
        // tie the spinner and slider together
        slider.addEventListener('input', function() {
          spinner.value = slider.value;
        });
        spinner.addEventListener('change', function(){
          slider.value = spinner.value;
        });
        node.appendChild(slider)
      });
      var tobes = new fcontrols.Rangeful('hola', {
        label: 'hello',
        value: 2,
        min: 1,
        max: 10,
        callback: uu.setCrossFim.bind(uu)
      });
      var ssea = new fcontrols.Colours('blues', {
        label: 'The Spaceships Of The Ocean',
        value: '#feede0',
        callback: uu.setRed.bind(uu)
      });
      tobes.appendMe("#flag-controls")

    }
  </script>
 </body>
</html>
